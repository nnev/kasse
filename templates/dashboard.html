<div class="demo-grid-1 mdl-grid">
  <!-- Account data -->
  <div class="mdl-cell mdl-cell--4-col card-account-data">
	<div class="mdl-card mdl-shadow--2dp">
	  <div class="mdl-card__title">
		<h2 class="mdl-card__title-text">{{ .User.Name }}</h2>
	  </div>
	  <div class="mdl-card__media card-account-data--balance">
        <div>{{ .Balance }}€</div>
	  </div>
	  <div class="mdl-card__actions mdl-card--border">
        <button class="mdl-button mdl-button--accent mdl-jso-button mdl-js-ripple-effect">
          Aufladen
        </button>
	  </div>
	</div>
  </div>

  <!-- Registered tags -->
  <div class="mdl-cell mdl-cell--4-col">
	<div class="mdl-card mdl-shadow--2dp card-registered-tags">
	  <div class="mdl-card__title">
		<h2 class="mdl-card__title-text">Registrierte Karten</h2>
	  </div>

	  <div class="mdl-card__media">
		{{ if .Cards }}
		<table id="cardtable" class="mdl-data-table mdl-js-data-table">
		  <thead>
			<tr>
				<th class="mdl-data-table__cell--non-numeric">UID</th>
				<th class="mdl-data-table__cell--non-numeric">Bezeichnung</th>
			</tr>
		  </thead>
		  <tbody>
            {{ range .Cards }}
			<tr carduid="{{ printf "%x" .ID }}">
				<td class="mdl-data-table__cell--non-numeric">{{ printf "%x" .ID }}</td>
				<td class="mdl-data-table__cell--non-numeric">{{ .Description }}</td>
			</tr>
            {{ end }}
		  </tbody>
		</table>
		{{ else }}
		<div class="no-registered-tags">Keine</div>
		{{ end }}
	  </div>
	  <div class="mdl-card__menu">
      <a href="/add_card.html">
        <button class="mdl-button mdl-button--fab mdl-button--mini-fab mdl-button--colored mdl-js-button mdl-js-ripple-effect">
          <i class="material-icons">add</i>
        </button>
      </a>
	  </div>
	</div>
  </div>
    <dialog id="dialog" class="mdl-dialog">
		<h3 class="mdl-dialog__title">Delete Card</h3>
		<div class="mdl-dialog__content">
			<p>
                Do you want to delete the following card?
			</p>
            <p id="dialog_carduid"></p>
		</div>
		<div class="mdl-dialog__actions">
			<button type="button" class="mdl-button dialog-close">Close</button>
			<button type="button" class="mdl-button dialog-delete">Delete</button>
		</div>
	</dialog>

	<script src="static/dialog-polyfill.js"></script>
	<script>
		function onRowClick(tableId, callback) {
			var table = document.getElementById(tableId),
					rows = table.getElementsByTagName("tr"),
					i;
			for (i = 0; i < rows.length; i++) {
				table.rows[i].onclick = function (row) {
					return function () {
						callback(row);
					};
				}(table.rows[i]);
			}
		}

		onRowClick("cardtable", function (row){
			carduid = row.getAttribute("carduid");
			if (carduid != null) {
				document.getElementById("dialog_carduid").innerHTML = carduid;
				dialog.showModal();
			}
		});

		(function() {
			'use strict';
			var dialogButton = document.querySelector('.dialog-button');
			var dialog = document.querySelector('#dialog');
			if (! dialog.showModal) {
				dialogPolyfill.registerDialog(dialog);
			}
			dialog.querySelector('.dialog-close')
					.addEventListener('click', function(button) {
						dialog.close();
					});
			dialog.querySelector('.dialog-delete')
				.addEventListener('click', function(button) {
				});
			}());
	</script>

  <!-- Last transactions -->
  <div class="mdl-cell mdl-cell--4-col">
	<div class="mdl-card mdl-shadow--2dp card-last-transactions">
	  <div class="mdl-card__title">
		<h2 class="mdl-card__title-text">Letzte Transaktionen</h2>
	  </div>

	  <div class="mdl-card__media">
		{{ if .Transactions }}
		<table class="mdl-data-table mdl-js-data-table">
		  <thead>
			<tr>
				<th class="mdl-data-table__cell--non-numeric">Karte</th>
				<th class="mdl-data-table__cell--non-numeric">Zeit</th>
				<th>Betrag</th>
			</tr>
		  </thead>
		  <tbody>
            {{ range .Transactions }}
			<tr>
				<td class="mdl-data-table__cell--non-numeric">{{ printf "%x" .Card }}</td>
				<td class="mdl-data-table__cell--non-numeric"><time>{{ .Time.Format "2006-01-02 15:04" }}</time></td>
				<td class="mdl-data-table__cell--non-numeric">{{ toEuros .Amount }}€</td>
			</tr>
            {{ end }}
		  </tbody>
		</table>
		{{ else }}
		<div class="no-transactions">Keine</div>
		{{ end }}
	  </div>
	  <div class="mdl-card__actions mdl-card--border">
        <button class="mdl-button mdl-button--accent mdl-jso-button mdl-js-ripple-effect">
          Mehr
        </button>
	  </div>
	</div>
  </div>
</div>
